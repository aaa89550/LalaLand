# 年齡驗證功能實作說明

## 📋 功能概述

為了確保約炮區的內容符合成人標準，我們實作了一個年齡驗證系統。當用戶嘗試進入約炮區時，會彈出年齡驗證彈跳視窗，確認用戶是否已滿18歲。

## 🚀 功能特色

### 1. 彈跳式年齡驗證
- 當用戶點擊「約炮區」時會觸發年齡驗證彈跳視窗
- 美觀的 UI 設計，包含警告圖示和清楚的說明文字
- 提供「是，已滿18歲」和「否，未滿18歲」兩個選項

### 2. 智能跳轉機制
- **已滿18歲**：允許進入約炮區，並顯示歡迎訊息
- **未滿18歲**：自動跳轉至閒聊區，並顯示提示訊息
- **關閉彈窗**：跳轉至閒聊區，保持安全

### 3. 會話記憶功能
- 使用 `sessionStorage` 記住驗證結果
- 在同一次瀏覽會話中，已驗證的用戶不需要重複驗證
- 關閉瀏覽器重新開啟後需要重新驗證

### 4. 多重防護機制
- **Sidebar 防護**：在側邊欄點擊約炮區時觸發驗證
- **GroupChat 防護**：直接進入約炮區時也會觸發驗證
- 雙重保護確保任何進入方式都會經過年齡驗證

## 📁 檔案結構

```
src/
├── components/
│   ├── common/
│   │   └── AgeVerificationModal.jsx    # 年齡驗證彈跳視窗組件
│   └── chat/
│       ├── Sidebar.jsx                 # 修改：加入年齡驗證邏輯
│       └── GroupChat.jsx               # 修改：加入防護邏輯
```

## 🎨 UI 設計特色

- **響應式設計**：在各種螢幕尺寸上都能正常顯示
- **深色模式支援**：完美適配深色/淺色主題
- **動畫效果**：流暢的開啟/關閉動畫
- **視覺提示**：警告圖示和清楚的色彩區分
- **無障礙設計**：良好的對比度和可讀性

## 💻 實作細節

### 1. AgeVerificationModal 組件
```jsx
// 主要 props
isOpen: boolean          // 控制彈窗顯示
onConfirm: () => void     // 已滿18歲的回調
onReject: () => void      // 未滿18歲的回調
onClose: () => void       // 關閉彈窗的回調
```

### 2. 驗證邏輯
```javascript
// 檢查是否需要驗證
useEffect(() => {
  if (roomId === 'sex') {
    const ageVerified = sessionStorage.getItem('ageVerified')
    if (!ageVerified) {
      setShowAgeVerification(true)
    }
  }
}, [roomId])

// 驗證成功後記住結果
sessionStorage.setItem('ageVerified', 'true')
```

### 3. 跳轉處理
```javascript
// 未滿18歲處理
onReject={() => {
  setCurrentRoom('chat')
  setShowAgeVerification(false)
  toast.error('未滿18歲無法進入約炮區，已自動跳轉至閒聊區。')
}}
```

## 🔒 安全考量

1. **前端驗證**：這是一個用戶體驗層面的驗證，主要用於提醒和引導
2. **會話級別**：每次瀏覽會話都需要重新確認，避免長期記住
3. **無資料收集**：不收集或儲存用戶的真實年齡資訊
4. **易於繞過**：技術熟練的用戶仍可繞過，但能有效防止意外進入

## 🚀 測試方式

1. 啟動開發伺服器：`npm run dev`
2. 進入應用程式
3. 點擊側邊欄的「約炮區」
4. 觀察年齡驗證彈跳視窗
5. 測試不同選項的跳轉行為

## 📝 注意事項

- 此功能主要用於用戶體驗和合規性提醒
- 不是真正的安全防護機制
- 建議後續可考慮加入更嚴格的後端驗證
- 符合大多數成人內容平台的標準做法

## 🎯 未來增強

1. **記錄功能**：記錄用戶的驗證行為（匿名化）
2. **更嚴格驗證**：結合身份驗證的年齡驗證
3. **自定義提示**：允許管理員自定義驗證文字
4. **多語言支援**：支援不同語言的驗證介面

---

**✅ 年齡驗證功能已成功實作並運行！**