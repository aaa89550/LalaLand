# Firebase Realtime Database 安全規則說明

## 規則概述
這個規則設計為較為寬鬆但仍有基本安全性的聊天應用規則。

## 各節點權限說明

### 1. 聊天訊息 (`/chats/$roomId/messages`)
- **讀取權限**: 所有已登入用戶可讀
- **寫入權限**: 已登入用戶可寫，但只能寫入自己發送的訊息或新訊息
- **用途**: 群組聊天室訊息（閒聊區、找伴區、約炮區）

### 2. 用戶資料 (`/users/$userId`)
- **讀取權限**: 所有已登入用戶可讀取所有用戶資料
- **寫入權限**: 用戶只能寫入/修改自己的資料
- **用途**: 用戶個人資料、在線狀態、暱稱等

### 3. 私人訊息 (`/privateChats/$chatId`)
- **讀取權限**: 只有對話參與者可以讀取
- **寫入權限**: 只有對話參與者可以寫入
- **訊息寫入**: 用戶只能寫入自己發送的訊息
- **用途**: 一對一私人聊天

### 4. 私人訊息列表 (`/privateChatsList/$userId`)
- **讀取權限**: 用戶只能讀取自己的私訊列表
- **寫入權限**: 用戶只能修改自己的私訊列表
- **用途**: 每個用戶的私訊對話列表

### 5. 系統設定 (`/settings`)
- **讀取權限**: 所有已登入用戶可讀
- **寫入權限**: 禁止寫入（管理員專用）
- **用途**: 系統設定、公告等

### 6. 通知公告 (`/announcements`)
- **讀取權限**: 所有已登入用戶可讀
- **寫入權限**: 禁止寫入（管理員專用）
- **用途**: 系統通知、公告等

## 安全特性

1. **基本認證**: 所有操作都需要用戶登入 (`auth != null`)
2. **數據隔離**: 用戶只能修改自己的資料
3. **私訊保護**: 私人訊息只有參與者可以訪問
4. **訊息完整性**: 用戶不能修改他人的訊息
5. **匿名用戶支持**: 支援 Firebase Anonymous Authentication

## 使用方式

1. 複製 `firebase-database-rules.json` 的內容
2. 在 Firebase Console 中：
   - 進入 Realtime Database
   - 點擊「規則」標籤
   - 貼上規則內容
   - 點擊「發布」

## 注意事項

- 這是較為寬鬆的規則，適合開發和測試環境
- 生產環境可能需要更嚴格的驗證
- 建議定期檢查和更新安全規則
- 可以根據實際需求調整權限設定