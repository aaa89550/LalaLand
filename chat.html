<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <script>
  if (localStorage.getItem('darkMode') === 'yes') {
    document.documentElement.classList.add('dark');
  }
  </script>
  <link rel="stylesheet" href="style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  
  <!-- åŸºæœ¬SEO Meta Tags -->
  <title>LalaLandå¥³åŒèŠå¤©å®¤ - å³æ™‚èŠå¤©å¹³å° | å¥³æ€§LGBTQ+ç¤¾ç¾¤</title>
  <meta name="description" content="åœ¨LalaLandå¥³åŒèŠå¤©å®¤èˆ‡å¿—åŒé“åˆçš„æœ‹å‹å³æ™‚èŠå¤©ï¼Œäº«å—å®‰å…¨å‹å–„çš„äº¤æµç’°å¢ƒã€‚æ”¯æ´ç¾¤çµ„èŠå¤©ã€ç§äººè¨Šæ¯ã€è¡¨æƒ…ç¬¦è™Ÿç­‰è±å¯ŒåŠŸèƒ½ã€‚">
  <meta name="keywords" content="å¥³åŒå³æ™‚èŠå¤©,ç¾¤çµ„èŠå¤©,ç§äººè¨Šæ¯,å¥³åŒç¤¾ç¾¤èŠå¤©,æ‹‰æ‹‰äº¤æµ,å³æ™‚é€šè¨Š,å®‰å…¨èŠå¤©">
  <meta name="robots" content="noindex, nofollow">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="webapp">
  <meta property="og:url" content="https://www.lalaland-chat.tw/chat.html">
  <meta property="og:title" content="LalaLandå¥³åŒèŠå¤©å®¤ - å³æ™‚èŠå¤©å¹³å°">
  <meta property="og:description" content="åœ¨LalaLandèˆ‡å¿—åŒé“åˆçš„æœ‹å‹å³æ™‚èŠå¤©ï¼Œäº«å—å®‰å…¨å‹å–„çš„äº¤æµç’°å¢ƒã€‚">
  <meta property="og:image" content="https://www.lalaland-chat.tw/icon-512.png">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://www.lalaland-chat.tw/chat.html">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
  <style>
    #loader {
      position: fixed;
      left: 0; top: 0; right: 0; bottom: 0;
      background: var(--bg, #f7f1e1);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: opacity 0.5s;
    }
    #loader.hide {
      opacity: 0;
      pointer-events: none;
    }
    .loader-spinner {
      border: 6px solid #eee;
      border-top: 6px solid var(--accent, #2877b9);
      border-radius: 50%;
      width: 48px;
      height: 48px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div id="loader"><div class="loader-spinner"></div></div>
  <!-- æ‰‹æ©Ÿç‰ˆæ¼¢å ¡æŒ‰éˆ•å’ŒæŠ½å±œ sidebarï¼šæ”¾åœ¨ #main ä¹‹å‰ -->
  <button id="mobile-sidebar-btn" class="mobile-sidebar-btn">â˜°</button>
  <span style="font-size: 0px; margin-right: 2px;"></span> 
  <div id="mobile-sidebar-drawer" class="mobile-sidebar-drawer">
    <div class="mobile-sidebar-content">
      <!-- XæŒ‰éˆ•åœ¨å·¦é‚Šï¼Œå¤œé–“æ¨¡å¼åœ¨å³é‚Š -->
      <div class="mobile-header">
        <button id="close-mobile-sidebar" class="close-mobile-sidebar">&times;</button>
        <button id="toggle-night-mode-mobile" class="mobile-night-mode-btn">ğŸŒ™</button>
      </div>
      
      <!-- æ‰‹æ©Ÿç‰ˆç”¨æˆ¶è³‡æ–™ -->
      <div class="mobile-user-profile">
        <img id="mobile-user-avatar" class="mobile-avatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23ddd'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16'%3EğŸ‘¤%3C/text%3E%3C/svg%3E" alt="ç”¨æˆ¶é ­åƒ">
        <span id="mobile-user-nickname" class="mobile-nickname">è¼‰å…¥ä¸­...</span>
      </div>



      <!-- åœ¨ç·šæˆå“¡ï¼ˆç°¡åŒ–ç‰ˆï¼‰ -->
      <div class="mobile-online-section">
        <h4>åœ¨ç·šæˆå“¡ <span id="mobile-online-count">(0)</span></h4>
        <div class="mobile-online-list">
          <ul id="user-list-mobile"></ul>
        </div>
      </div>

      <!-- æ‰‹æ©Ÿç‰ˆåŠŸèƒ½æŒ‰éˆ• -->
      <div class="mobile-actions">
        <button id="mobile-view-friends-btn" class="mobile-action-btn">æˆ‘çš„å¥½å‹</button>
        <button id="edit-profile-btn-mobile" class="mobile-action-btn">ç·¨è¼¯è³‡æ–™</button>
        <button id="notification-settings-btn-mobile" class="mobile-action-btn">ğŸ”” é€šçŸ¥è¨­å®š</button>
        <button id="logout-btn-mobile" class="mobile-action-btn logout">ç™»å‡º</button>
      </div>
    </div>
  </div>
  <!-- ä¸»ç•«é¢ -->
  <div id="main">
    <div id="sidebar">
  <!-- ç”¨æˆ¶è³‡æ–™å€ -->
  <div class="user-profile-section">
    <div class="user-info" id="user-info-dropdown">
      <img id="user-avatar" class="user-main-avatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23ddd'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16'%3EğŸ‘¤%3C/text%3E%3C/svg%3E" alt="ç”¨æˆ¶é ­åƒ">
      <div class="user-details">
        <span id="user-nickname" class="user-nickname">è¼‰å…¥ä¸­...</span>
        <span class="dropdown-arrow">â–¼</span>
      </div>
    </div>
    <div id="user-dropdown-menu" class="user-dropdown-menu" style="display: none;">
      <button id="view-friends-btn" class="dropdown-item">æˆ‘çš„å¥½å‹</button>
      <button id="edit-profile-btn" class="dropdown-item">ç·¨è¼¯å€‹äººè³‡æ–™</button>
      <button id="notification-settings-btn" class="dropdown-item">ğŸ”” é€šçŸ¥è¨­å®š</button>
      <button id="logout-btn" class="dropdown-item logout-btn">ç™»å‡º</button>
    </div>
  </div>

  <!-- åœ¨ç·šæˆå“¡å€ -->
  <div class="online-header">
    <h3>åœ¨ç·šæˆå“¡</h3>
    <button id="toggle-night-mode" class="night-icon-btn" title="åˆ‡æ›æ—¥å¤œé–“æ¨¡å¼">ğŸŒ™</button>
  </div>
  <div class="tip-small">
    é»é¸æˆå“¡å¯é€²å…¥ä¸€å°ä¸€ç§è¨Š
  </div>
  
  <ul id="user-list"></ul>

  <!-- éš±è—åŸæœ‰æŒ‰éˆ• -->
  <div style="display: none;">
    <button id="show-friends" class="sidebar-btn">æˆ‘çš„å¥½å‹</button>
    <div id="friend-area">
      <ul id="friend-list"></ul>
    </div>
    <button id="group-chat-list-btn" class="sidebar-btn">å¤§ç¾¤çµ„åˆ—è¡¨</button>
    <div id="group-chat-area">
      <ul id="group-chat-list">
        <li class="group-chat-item" data-room="chat">é–’èŠ</li>
        <li class="group-chat-item" data-room="love">æ‰¾ä¼´</li>
        <li class="group-chat-item" data-room="sex">ç´„ç‚®</li>
      </ul>
    </div>
    <button id="edit-profile-btn-old" class="sidebar-btn">ç·¨è¼¯å€‹äººè³‡æ–™</button>
    <button id="logout-btn-old" class="sidebar-btn">ç™»å‡º</button>
  </div>
</div>
  <div id="content">
      <!-- ç§è¨Šé€šçŸ¥æ¬„ -->
      <div id="notification-bar" class="notification-bar" style="display: none;">
        <div class="notification-content">
          <span id="notification-text">æ”¶åˆ°æ–°ç§è¨Š</span>
          <button id="notification-close" class="notification-close">&times;</button>
        </div>
      </div>
      
      <!-- èŠå¤©å®¤åˆ†é¡æ¨™ç±¤ -->
      <div id="chat-tabs" class="chat-tabs">
        <button class="chat-tab active" data-room="chat" onclick="console.log('é»æ“Šé–’èŠæ¨™ç±¤'); window.switchChatRoom ? switchChatRoom('chat') : alert('åŠŸèƒ½è¼‰å…¥ä¸­...')">é–’èŠ</button>
        <button class="chat-tab" data-room="love" onclick="console.log('é»æ“Šæ‰¾ä¼´æ¨™ç±¤'); window.switchChatRoom ? switchChatRoom('love') : alert('åŠŸèƒ½è¼‰å…¥ä¸­...')">æ‰¾ä¼´</button>
        <button class="chat-tab" data-room="sex" onclick="console.log('é»æ“Šç´„ç‚®æ¨™ç±¤'); window.switchChatRoom ? switchChatRoom('sex') : alert('åŠŸèƒ½è¼‰å…¥ä¸­...')">ç´„ç‚®</button>
        <button class="chat-tab" data-room="private" onclick="console.log('é»æ“Šç§è¨Šæ¨™ç±¤'); window.switchChatRoom ? switchChatRoom('private') : alert('åŠŸèƒ½è¼‰å…¥ä¸­...')">ç§è¨Š</button>
      </div>
      
      <div class="tip" id="chat-tip" style="display:none; font-size: 11px; color: #999; padding: 4px 8px; margin: 4px 0;"></div>
  <div id="chat-action" style="margin-top: 4px;"></div>
      <div id="chat"></div>
<div id="input-preview" style="display: none;"></div>


<div id="input-area">
  <!-- é›»è…¦ç‰ˆ + æŒ‰éˆ• -->
  <button id="plus-btn" class="plus-btn desktop-only">ï¼‹</button>

<!-- é›»è…¦ç‰ˆèœå–®ï¼ˆç¨ç«‹å€åŸŸï¼‰ -->
<div id="plus-menu" class="desktop-only" style="display: none;">
  <button id="emoji-btn" title="æ’å…¥è¡¨æƒ…" class="plus-btn">ğŸ˜Š</button>
  <button id="upload-btn" class="plus-btn">ğŸ–¼ï¸</button>
  <input type="file" id="upload-input" accept="image/*" style="display: none;" />
  <button id="vote-btn" class="plus-btn">ğŸ—³ï¸</button>
</div>
<div id="emoji-picker" style="display: none;">
  <div class="emoji-container">
    <span>ğŸ˜‚</span><span>ğŸ˜</span><span>ğŸ¥º</span><span>ğŸ˜¡</span><span>ğŸ˜­</span>
    <span>ğŸ˜</span><span>ğŸ˜³</span><span>ğŸ˜˜</span><span>ğŸ¤£</span><span>ğŸ˜Š</span>
    <span>ğŸ˜´</span><span>ğŸ™„</span><span>ğŸ±</span><span>ğŸ¸</span><span>ğŸ¦Š</span>
    <span>ğŸŒˆ</span><span>â¤ï¸</span><span>ğŸ«¶</span><span>ğŸ‘­</span><span>âœ¨</span><span>ğŸ’‹</span>
  </div>
</div>
<div id="edit-profile-modal" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close" id="close-profile-modal">&times;</span>
      <form id="edit-profile-form">
        <label>æš±ç¨±ï¼š<input type="text" id="edit-nickname" required></label><br>
        <label>é ­åƒï¼š<input type="file" id="edit-avatar" accept="image/*"></label><br>
        <img id="edit-avatar-preview" style="width:64px;height:64px;display:none;border-radius:50%;">
        <button type="submit">å„²å­˜</button>
      </form>
    </div>
  </div>
  
  <!-- é€šçŸ¥è¨­å®šå½ˆçª— -->
  <div id="notification-settings-modal" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close" id="close-notification-modal">&times;</span>
      <h3>ğŸ”” é€šçŸ¥è¨­å®š</h3>
      
      <div style="margin: 20px 0;">
        <h4>ç³»çµ±é€šçŸ¥</h4>
        <p id="notification-status" style="margin: 10px 0; padding: 10px; border-radius: 5px;"></p>
        <button id="request-notification-btn" style="margin: 10px 0; padding: 10px 20px;">
          å•Ÿç”¨ç³»çµ±é€šçŸ¥
        </button>
        <p style="font-size: 14px; color: #666; margin-top: 10px;">
          å•Ÿç”¨å¾Œï¼Œå³ä½¿ä¸åœ¨èŠå¤©é é¢ä¹Ÿæœƒæ”¶åˆ°æ–°ç§è¨Šçš„ç³»çµ±é€šçŸ¥
        </p>
      </div>
      <div style="margin: 20px 0;">
        <h4>æ¸¬è©¦é€šçŸ¥</h4>
        <button id="test-notification-btn" style="padding: 10px 20px;">
          ç™¼é€æ¸¬è©¦é€šçŸ¥
        </button>
      </div>
    </div>
  </div>
  
  <div id="vote-modal" class="modal" style="display:none;">
  <div class="modal-content" style="max-width:400px;">
    <span class="close" id="close-vote-modal">&times;</span>
    <h3>ç™¼èµ·æŠ•ç¥¨</h3>
    <label>å•é¡Œï¼š</label>
    <input type="text" id="vote-question" placeholder="è«‹è¼¸å…¥å•é¡Œ" style="width:100%; margin-bottom:10px;">
    <div id="vote-options">
      <input type="text" class="vote-option-input" placeholder="é¸é … 1">
      <input type="text" class="vote-option-input" placeholder="é¸é … 2">
    </div>
    <button id="add-option-btn">â• æ–°å¢é¸é …</button>
    <button id="submit-vote-btn" style="margin-top:12px;">é€å‡ºæŠ•ç¥¨</button>
  </div>
</div>
  <input id="msg" type="text" placeholder="è¼¸å…¥è¨Šæ¯..." autocomplete="off">
  <button id="send">é€å‡º</button>
</div>


  </div>
  <script>
    // è¼‰å…¥å‹•ç•«
    window.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        document.getElementById('loader').classList.add('hide');
      }, 600);
      
      // æª¢æŸ¥å…¨åŸŸå‡½æ•¸æ˜¯å¦å¯ç”¨
      setTimeout(() => {
        if (typeof window.switchChatRoom === 'function') {
          console.log('âœ… switchChatRoom å‡½æ•¸å·²æº–å‚™å°±ç·’');
        } else {
          console.error('âŒ switchChatRoom å‡½æ•¸æœªæ‰¾åˆ°');
          // æä¾›å¾Œå‚™å‡½æ•¸
          window.switchChatRoom = function(room) {
            console.log('ğŸ”„ å¾Œå‚™ï¼šåˆ‡æ›èŠå¤©å®¤:', room);
            alert('æ­£åœ¨åˆ‡æ›åˆ°ï¼š' + room + ' èŠå¤©å®¤');
          };
        }
      }, 1000);
    });
  </script>
  <script src="splash.js"></script>
  <script src="linkify.js"></script>
  <script type="module" src="main.js"></script>
</body>
</html>
